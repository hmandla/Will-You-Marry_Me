<script>
  let noClicks = 0;
  const noBtn = document.getElementById("noButton");

  function handleYes() {
    document.getElementById('mainContent').innerHTML = "<h1>Yay! 💍❤️ Let's celebrate! 🎉</h1>";
    launchConfetti();
  }

  function handleNo() {
    noClicks++;
    const h1 = document.querySelector('h1');

    if (noClicks === 1) {
      h1.textContent = "Please don't do this 😢";
    } else if (noClicks === 2) {
      h1.textContent = "I'm about to cry 😭";
    } else if (noClicks === 3) {
      h1.textContent = "Are you serious? 💔";
    } else {
      document.getElementById('mainContent').innerHTML = `
        <h1>There's only one right answer 🥹</h1>
        <button class="btn yes" onclick="handleYes()">💍 Yes</button>
      `;
    }
  }

  let allowMove = true;

  function moveNo() {
    if (!allowMove) return;

    const btnWidth = noBtn.offsetWidth;
    const btnHeight = noBtn.offsetHeight;
    const windowWidth = window.innerWidth;
    const windowHeight = window.innerHeight;

    const newX = Math.random() * (windowWidth - btnWidth);
    const newY = Math.random() * (windowHeight - btnHeight);

    noBtn.style.left = `${newX}px`;
    noBtn.style.top = `${newY}px`;
  }

  // Enable click after hover movement
  noBtn.addEventListener("click", () => {
    allowMove = false; // stop moving after click
    handleNo();
    setTimeout(() => {
      allowMove = true; // re-enable float after a second
    }, 1500);
  });

  // Confetti function
  function launchConfetti() {
    const duration = 10 * 1000;
    const end = Date.now() + duration;

    (function frame() {
      confetti({
        particleCount: 4,
        angle: 60,
        spread: 55,
        origin: { x: 0 }
      });
      confetti({
        particleCount: 4,
        angle: 120,
        spread: 55,
        origin: { x: 1 }
      });

      if (Date.now() < end) {
        requestAnimationFrame(frame);
      }
    })();
  }

  // Trigger music playback on user interaction
  document.addEventListener('click', function () {
    const music = document.getElementById("bgMusic");
    if (music.paused) {
      music.play().catch(() => {});
    }
  }, { once: true });
</script>
